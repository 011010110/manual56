###5.4.1. InnoDB 表空间管理
####5.4.1.1. 独立表空间模式的开启和关闭
####5.4.1.2. 表空间路径配置
####5.4.1.3. 拷贝表空间到其实例（可移植表空间）
####5.4.1.4 将撤销日志移出共享表空间
之前，InnoDB的表和索引都存储在共享表空间中。整个策略目的在于数据库运行中的机器专用，随着数据的不断增长，分配给MySQL的磁盘空间不会再作其他用途。InnoDB的独立表空间模式是另一种灵活的选择，你可以将每一个InnoDB表和它的引擎进行单独存储。每一个以.ibd为后缀的文件代表一个独立表空间。参数innodb_file_per_table用于控制是否启用独立表空间。在MySQL 5.6.6和之后的版本为默认开启。

独立表空间的优势

* 清空或者删除表时回收磁盘空间。独立表空间模式关闭时，清空或者删除表会在共享表空间中产生空闲空间，这些空闲空间只能用于新数据。（即磁盘空间不会回收）
* TRUNCATE TABLE 语句在独立表空间模式下执行更快。
* 你可以将特定的表存储在独立的存储设备上，从而进行磁盘I/O优化，磁盘空间管理，备份等。在之前的版本中，你需要移动整个数据目录到其他设备并创建符号连接。如Section 8.11.3.1, “Using Symbolic Links” 中所述。在MySQL 5.6 和之后的版本，你可以为每张表指定路径：CREATE TABLE … DATA DIRECTORY =absolute_path_to_directory,详见： Section 5.4.1.2, “Specifying the Location of a Tablespace”。
* 你可以使用OPTIMIZE TABLE 语句来压缩或者重建表空间。当你执行OPTIMZIE TABLE语句时，InnoDB先创建一个临时命名的.ibd文件，只占用实际数据占用的空间。之后InnoDB会把原来的.idb文件替换为新的.ibd文件。如果旧的.ibd变得很大，但是实际存储的数据只是很小比例，运行OPTIMIZE TABLE语句可以回收空闲空间。
* 你可以移动个别的InnoDB表，而不是整个数据库。
* 你可以从一个实例拷贝个别的InnoDB表到另一个实例。（见transportalbe tablespace）
* 使用compressed_row_format来压缩你的表和索引数据
* 使用dynamic row formate可以有效存储更多的包含有BLOB或者text列的表
* 使用独立表空间有时可帮助一次有效的灾难恢复并缩短恢复时间，如崩溃，实例无法启动，或则备份和binlog无效
* 你可以快速对一个表进行单独的备份和恢复。使用MySQL 企业版备份工具可以不影响正常使用进行备份操作，功能和限制见Backing Up and Restoring a Single .ibd File
* 独立表空间模式可实现从备份计划中排出备份表。优势体现在如果你有一些不要持续备份或者特定周期的表时。
* 独立表空间模式可以不访问MySQL，直接从系统层面监控表的空间大小
* 当innodb_flush_method设置为O_DIRECT模式，一般的Linux系统不允许对单个文件进行并发写入，这样，使用独立表空间结合innodb_flush_method有一定程度上的性能优化。
* 如果不启用独立表空间，共享表空间将存储表数据，数据字典和撤销日志。单个表空间最大限制为64TB。如果启用共享表空间，每一个表拥有自己的表空间。详见 See Section E.10.3, “Limits on Table Size” 。

独立表空间可能存在的问题
* 独立表空间模式下，每一个表空间都有空闲空间，并且只会被同一个表的数据使用。如果管理不善，可能导致更多的空间浪费
* fsync 操作需要基于表为单位允许，而不是一个文件。因为每一个表需要单独的flush操作，对多个表的写入操作不能在一次磁盘I/O操作内完成。这需要InnoDB发起更多的磁盘刷新操作线程。
* mysqld 必须为每一个表打开一个文件句柄，如果你有非常多的表，这可能会影响性能
* 将使用更多的文件描述符
* 独立表空见在5.6.6和之后版本默认开启。考虑到向前兼容性问题，在5.5或者5.1版本中你可能会选择关闭独立表空间。禁用独立表空间可以防止ALTER TABLE 操作将表从共享表空间中移动到独立表空文件中。
* 随着表数据的变化，可能会产生越来越多的空间碎片，导致DROP TABLE和全表扫描收到影响。但是，如果碎片空间得到有效管理，独立表空将提升性能
* 独立表空间的表被删除时，缓存池将被扫描，由于缓存池一般有几十G的空间，扫描需要一定的时间。缓存池的扫描将获取一个大范围的内部锁，这个锁将影响其他查询操作。共享表空间中的表不受到影响。
* 参数innodb_autoexten_increment 定义了当自动扩展的共享表空间满时它每次自动增加的空间大小（MB），不作用于独立表空间。独立表空间文件自动增长并不受innodb_autoexten_increment参数影响。最初扩展是很小的空间，之后每次增加的空间大小为4MB。

 